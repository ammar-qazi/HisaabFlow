{
  "start_row": 13,
  "end_row": null,
  "start_col": 0,
  "end_col": 5,
  "column_mapping": {
    "Date": "TIMESTAMP",
    "Amount": "AMOUNT",
    "Category": "",
    "Title": "DESCRIPTION", 
    "Note": "TYPE",
    "Account": ""
  },
  "bank_name": "NayaPay",
  "default_currency": "PKR",
  "description": "NayaPay template for UNTOUCHED CSV files - handles clean 5-column structure with data cleaning",
  "created_date": "2025-06-05",
  "version": "4.0",
  "structure_notes": {
    "file_structure": "Untouched NayaPay CSVs have clean structure",
    "header_rows": "Headers are 2 columns (not 9 with padding)",
    "transaction_headers": "Row 13: TIMESTAMP,TYPE,DESCRIPTION,AMOUNT,BALANCE (5 columns)",
    "account_number_format": "Has leading apostrophe: '03142919528",
    "empty_rows": "Truly empty (0 columns), not padded with empty strings",
    "data_cleaning": "Template supports automatic data cleaning with currency addition"
  },
  "data_cleaning_config": {
    "enable_currency_addition": true,
    "default_currency": "PKR",
    "numeric_amount_conversion": true,
    "date_standardization": true,
    "remove_invalid_rows": true
  },
  "date_formats": [
    "dd MMM yyyy hh:mm AM/PM",
    "d MMM yyyy hh:mm AM/PM"
  ],
  "amount_parsing": {
    "format": "Comma-separated with quotes",
    "examples": ["\"-5,000\"", "\"+50,000\"", "\"872.40\""],
    "negative_prefix": "-",
    "positive_prefix": "+",
    "cleaned_format": "Numeric float values after data cleaning"
  },
  "categorization_rules": [
    {
      "rule_name": "Outgoing Fund Transfers (Raast Out) - Large Amounts",
      "priority": 1,
      "conditions": {
        "and": [
          {
            "field": "TYPE",
            "operator": "equals",
            "value": "Raast Out",
            "case_sensitive": false
          },
          {
            "field": "AMOUNT",
            "operator": "less_than",
            "value": -5000
          }
        ]
      },
      "actions": {
        "set_category": "Transfer",
        "clean_description": {
          "from_field": "DESCRIPTION",
          "rules": [
            {
              "pattern": "Outgoing fund transfer to",
              "replacement": "Transfer to"
            },
            {
              "pattern": "\\|Transaction ID [^\\n]*",
              "replacement": ""
            },
            {
              "pattern": "Transaction ID [^\\n]*",
              "replacement": ""
            }
          ],
          "default": "Transfer"
        }
      }
    },
    {
      "rule_name": "Mobile Top-ups",
      "priority": 2,
      "conditions": {
        "or": [
          {
            "field": "DESCRIPTION",
            "operator": "contains",
            "value": "mobile topup",
            "case_sensitive": false
          },
          {
            "field": "DESCRIPTION",
            "operator": "contains",
            "value": "recharge",
            "case_sensitive": false
          },
          {
            "field": "TYPE",
            "operator": "contains",
            "value": "topup",
            "case_sensitive": false
          }
        ]
      },
      "actions": {
        "set_category": "Bills & Fees",
        "set_title_template": "Mobile charge for {extract_name}",
        "extract_name": {
          "from_field": "DESCRIPTION",
          "pattern": "Nickname:\\s*([^|\\n]+)",
          "group": 1,
          "default": "Unknown Contact"
        }
      }
    },
    {
      "rule_name": "Ride Hailing Services - EasyPaisa",
      "priority": 3,
      "conditions": {
        "and": [
          {
            "field": "TYPE",
            "operator": "equals",
            "value": "Raast Out",
            "case_sensitive": false
          },
          {
            "field": "AMOUNT",
            "operator": "range",
            "min": -2000,
            "max": -100
          },
          {
            "field": "DESCRIPTION",
            "operator": "contains",
            "value": "easypaisa",
            "case_sensitive": false
          }
        ]
      },
      "actions": {
        "set_category": "Travel",
        "set_title": "Ride Hailing App"
      }
    },
    {
      "rule_name": "Ride Hailing Services - Small Transfers",
      "priority": 4,
      "conditions": {
        "and": [
          {
            "field": "TYPE",
            "operator": "equals",
            "value": "Raast Out",
            "case_sensitive": false
          },
          {
            "field": "AMOUNT",
            "operator": "range",
            "min": -1500,
            "max": -100
          }
        ]
      },
      "actions": {
        "set_category": "Travel",
        "set_title": "Ride Hailing App"
      }
    },
    {
      "rule_name": "Incoming Fund Transfers (IBFT In)",
      "priority": 5,
      "conditions": {
        "and": [
          {
            "field": "TYPE",
            "operator": "equals",
            "value": "IBFT In",
            "case_sensitive": false
          }
        ]
      },
      "actions": {
        "set_category": "Transfer",
        "clean_description": {
          "from_field": "DESCRIPTION",
          "rules": [
            {
              "pattern": "Incoming fund transfer from",
              "replacement": "Transfer from"
            },
            {
              "pattern": "\\|Transaction ID [^\\n]*",
              "replacement": ""
            },
            {
              "pattern": "Transaction ID [^\\n]*",
              "replacement": ""
            }
          ],
          "default": "Transfer"
        }
      }
    },
    {
      "rule_name": "Peer to Peer Transfers",
      "priority": 6,
      "conditions": {
        "and": [
          {
            "field": "TYPE",
            "operator": "equals",
            "value": "Peer to Peer",
            "case_sensitive": false
          }
        ]
      },
      "actions": {
        "set_category": "Transfer",
        "clean_description": {
          "from_field": "DESCRIPTION",
          "rules": [
            {
              "pattern": "Money sent to",
              "replacement": "Transfer to"
            },
            {
              "pattern": "\\|Transaction ID [^\\n]*",
              "replacement": ""
            },
            {
              "pattern": "Transaction ID [^\\n]*",
              "replacement": ""
            }
          ],
          "default": "Transfer"
        }
      }
    },
    {
      "rule_name": "Remaining Raast Out Transfers",
      "priority": 7,
      "conditions": {
        "and": [
          {
            "field": "TYPE",
            "operator": "equals",
            "value": "Raast Out",
            "case_sensitive": false
          }
        ]
      },
      "actions": {
        "set_category": "Transfer",
        "clean_description": {
          "from_field": "DESCRIPTION",
          "rules": [
            {
              "pattern": "Outgoing fund transfer to",
              "replacement": "Transfer to"
            },
            {
              "pattern": "\\|Transaction ID [^\\n]*",
              "replacement": ""
            },
            {
              "pattern": "Transaction ID [^\\n]*",
              "replacement": ""
            }
          ],
          "default": "Transfer"
        }
      }
    },
    {
      "rule_name": "Surraiya Riaz Transactions",
      "priority": 8,
      "conditions": {
        "and": [
          {
            "field": "DESCRIPTION",
            "operator": "contains",
            "value": "Surraiya Riaz",
            "case_sensitive": false
          }
        ]
      },
      "actions": {
        "set_title": "Zunayyara Quran"
      }
    },
    {
      "rule_name": "ATM Withdrawals",
      "priority": 9,
      "conditions": {
        "and": [
          {
            "field": "TYPE",
            "operator": "contains",
            "value": "ATM",
            "case_sensitive": false
          },
          {
            "field": "AMOUNT",
            "operator": "less_than",
            "value": 0
          }
        ]
      },
      "actions": {
        "set_category": "Cash",
        "set_title": "ATM Withdrawal"
      }
    },
    {
      "rule_name": "Bank Transfers Out",
      "priority": 10,
      "conditions": {
        "and": [
          {
            "field": "TYPE",
            "operator": "equals",
            "value": "Transfer Out",
            "case_sensitive": false
          }
        ]
      },
      "actions": {
        "set_category": "Transfer",
        "keep_original_title": true
      }
    },
    {
      "rule_name": "Bank Transfers In",
      "priority": 11,
      "conditions": {
        "and": [
          {
            "field": "TYPE",
            "operator": "equals",
            "value": "Transfer In",
            "case_sensitive": false
          }
        ]
      },
      "actions": {
        "set_category": "Transfer",
        "keep_original_title": true
      }
    },
    {
      "rule_name": "Salary Income",
      "priority": 12,
      "conditions": {
        "and": [
          {
            "field": "DESCRIPTION",
            "operator": "contains",
            "value": "salary",
            "case_sensitive": false
          },
          {
            "field": "AMOUNT",
            "operator": "greater_than",
            "value": 0
          }
        ]
      },
      "actions": {
        "set_category": "Income",
        "set_title": "Salary"
      }
    },
    {
      "rule_name": "Online Shopping",
      "priority": 13,
      "conditions": {
        "or": [
          {
            "field": "DESCRIPTION",
            "operator": "contains",
            "value": "amazon",
            "case_sensitive": false
          },
          {
            "field": "DESCRIPTION",
            "operator": "contains",
            "value": "daraz",
            "case_sensitive": false
          },
          {
            "field": "DESCRIPTION",
            "operator": "contains",
            "value": "aliexpress",
            "case_sensitive": false
          }
        ]
      },
      "actions": {
        "set_category": "Shopping",
        "set_title": "Online Shopping"
      }
    },
    {
      "rule_name": "Grocery Stores",
      "priority": 14,
      "conditions": {
        "or": [
          {
            "field": "DESCRIPTION",
            "operator": "contains",
            "value": "carrefour",
            "case_sensitive": false
          },
          {
            "field": "DESCRIPTION",
            "operator": "contains",
            "value": "metro",
            "case_sensitive": false
          },
          {
            "field": "DESCRIPTION",
            "operator": "contains",
            "value": "grocery",
            "case_sensitive": false
          }
        ]
      },
      "actions": {
        "set_category": "Groceries",
        "set_title": "Grocery Shopping"
      }
    }
  ],
  "default_category_rules": {
    "positive_amount": "Income",
    "negative_amount": "Expense",
    "zero_amount": "Transfer"
  }
}